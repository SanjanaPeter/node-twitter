{"ast":null,"code":"import _Reflect$construct from \"@babel/runtime-corejs2/core-js/reflect/construct\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _Promise from \"@babel/runtime-corejs2/core-js/promise\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/var/www/html/node-twitter/client/pages/index.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = _Reflect$construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false; if (_Reflect$construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(_Reflect$construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport { Component } from 'react';\nimport fetch from 'isomorphic-unfetch';\nimport Layout from './../components/layout';\nimport { login } from '../utils/auth';\n\nvar Index = /*#__PURE__*/function (_Component) {\n  _inherits(Index, _Component);\n\n  var _super = _createSuper(Index);\n\n  _createClass(Index, null, [{\n    key: \"getInitialProps\",\n    value: function getInitialProps(_ref) {\n      var req = _ref.req;\n      var protocol = process.env.NODE_ENV === 'production' ? 'https' : 'http';\n      var apiUrl = process.browser ? \"\".concat(protocol, \"://\").concat(window.location.host, \"/api/login.js\") : \"\".concat(protocol, \"://\").concat(req.headers.host, \"/api/login.js\");\n      return {\n        apiUrl: apiUrl\n      };\n    }\n  }]);\n\n  function Index(props) {\n    var _this;\n\n    _classCallCheck(this, Index);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      username: '',\n      error: ''\n    };\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_this));\n    _this.handleSubmit = _this.handleSubmit.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Index, [{\n    key: \"handleChange\",\n    value: function handleChange(event) {\n      this.setState({\n        username: event.target.value\n      });\n    }\n  }, {\n    key: \"handleSubmit\",\n    value: function () {\n      var _handleSubmit = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n        var username, url, response, _yield$response$json, token, error;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                event.preventDefault();\n                username = this.state.username;\n                url = this.props.apiUrl;\n                _context.prev = 3;\n                _context.next = 6;\n                return fetch(url, {\n                  method: 'POST',\n                  headers: {\n                    'Content-Type': 'application/json'\n                  },\n                  body: _JSON$stringify({\n                    username: username\n                  })\n                });\n\n              case 6:\n                response = _context.sent;\n\n                if (!response.ok) {\n                  _context.next = 15;\n                  break;\n                }\n\n                _context.next = 10;\n                return response.json();\n\n              case 10:\n                _yield$response$json = _context.sent;\n                token = _yield$response$json.token;\n                login({\n                  token: token\n                });\n                _context.next = 19;\n                break;\n\n              case 15:\n                console.log('Login failed.'); // https://github.com/developit/unfetch#caveats\n\n                error = new Error(response.statusText);\n                error.response = response;\n                return _context.abrupt(\"return\", _Promise.reject(error));\n\n              case 19:\n                _context.next = 25;\n                break;\n\n              case 21:\n                _context.prev = 21;\n                _context.t0 = _context[\"catch\"](3);\n                console.error('You have an error in your code or there are Network issues.', _context.t0);\n                throw new Error(_context.t0);\n\n              case 25:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[3, 21]]);\n      }));\n\n      function handleSubmit(_x) {\n        return _handleSubmit.apply(this, arguments);\n      }\n\n      return handleSubmit;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(Layout, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"jsx-923656326\" + \" \" + 'login',\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"form\", {\n        onSubmit: this.handleSubmit,\n        className: \"jsx-923656326\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"label\", {\n        htmlFor: \"username\",\n        className: \"jsx-923656326\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 13\n        }\n      }, \"GitHub username\"), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"text\",\n        id: \"username\",\n        name: \"username\",\n        value: this.state.username,\n        onChange: this.handleChange,\n        className: \"jsx-923656326\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 13\n        }\n      }), /*#__PURE__*/React.createElement(\"button\", {\n        type: \"submit\",\n        className: \"jsx-923656326\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 13\n        }\n      }, \"Login\"), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"jsx-923656326\" + \" \" + \"error \".concat(this.state.error && 'show'),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 13\n        }\n      }, this.state.error && \"Error: \".concat(this.state.error)))), /*#__PURE__*/React.createElement(_JSXStyle, {\n        id: \"923656326\",\n        __self: this\n      }, \".login.jsx-923656326{max-width:340px;margin:0 auto;padding:1rem;border:1px solid #ccc;border-radius:4px;}form.jsx-923656326{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:column;-ms-flex-flow:column;flex-flow:column;}label.jsx-923656326{font-weight:600;}input.jsx-923656326{padding:8px;margin:0.3rem 0 1rem;border:1px solid #ccc;border-radius:4px;}.error.jsx-923656326{margin:0.5rem 0 0;display:none;color:brown;}.error.show.jsx-923656326{display:block;}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvd3d3L2h0bWwvbm9kZS10d2l0dGVyL2NsaWVudC9wYWdlcy9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFnRm9CLEFBRzZCLEFBT0gsQUFJRyxBQUdKLEFBTU0sQUFLSixZQVZPLEVBV3ZCLEVBekJnQixBQVdoQixFQVNlLFlBbkJBLENBb0JELEVBTlUsVUFiQSxBQW9CeEIsWUFOb0IsVUFiQSxRQWNwQixDQVZtQixTQUhuQixzREFJQSIsImZpbGUiOiIvdmFyL3d3dy9odG1sL25vZGUtdHdpdHRlci9jbGllbnQvcGFnZXMvaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tICdyZWFjdCdcbmltcG9ydCBmZXRjaCBmcm9tICdpc29tb3JwaGljLXVuZmV0Y2gnXG5pbXBvcnQgTGF5b3V0IGZyb20gJy4vLi4vY29tcG9uZW50cy9sYXlvdXQnO1xuaW1wb3J0IHsgbG9naW4gfSBmcm9tICcuLi91dGlscy9hdXRoJ1xuXG5jbGFzcyBJbmRleCBleHRlbmRzIENvbXBvbmVudCB7XG4gIHN0YXRpYyBnZXRJbml0aWFsUHJvcHMgKHsgcmVxIH0pIHtcbiAgICBjb25zdCBwcm90b2NvbCA9IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicgPyAnaHR0cHMnIDogJ2h0dHAnXG5cbiAgICBjb25zdCBhcGlVcmwgPSBwcm9jZXNzLmJyb3dzZXJcbiAgICAgID8gYCR7cHJvdG9jb2x9Oi8vJHt3aW5kb3cubG9jYXRpb24uaG9zdH0vYXBpL2xvZ2luLmpzYFxuICAgICAgOiBgJHtwcm90b2NvbH06Ly8ke3JlcS5oZWFkZXJzLmhvc3R9L2FwaS9sb2dpbi5qc2BcblxuICAgIHJldHVybiB7IGFwaVVybCB9XG4gIH1cblxuICBjb25zdHJ1Y3RvciAocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcylcblxuICAgIHRoaXMuc3RhdGUgPSB7IHVzZXJuYW1lOiAnJywgZXJyb3I6ICcnIH1cbiAgICB0aGlzLmhhbmRsZUNoYW5nZSA9IHRoaXMuaGFuZGxlQ2hhbmdlLmJpbmQodGhpcylcbiAgICB0aGlzLmhhbmRsZVN1Ym1pdCA9IHRoaXMuaGFuZGxlU3VibWl0LmJpbmQodGhpcylcbiAgfVxuXG4gIGhhbmRsZUNoYW5nZSAoZXZlbnQpIHtcbiAgICB0aGlzLnNldFN0YXRlKHsgdXNlcm5hbWU6IGV2ZW50LnRhcmdldC52YWx1ZSB9KVxuICB9XG5cbiAgYXN5bmMgaGFuZGxlU3VibWl0IChldmVudCkge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KClcbiAgICBjb25zdCB1c2VybmFtZSA9IHRoaXMuc3RhdGUudXNlcm5hbWVcbiAgICBjb25zdCB1cmwgPSB0aGlzLnByb3BzLmFwaVVybFxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyB1c2VybmFtZSB9KVxuICAgICAgfSlcbiAgICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgICBjb25zdCB7IHRva2VuIH0gPSBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICAgICAgbG9naW4oeyB0b2tlbiB9KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coJ0xvZ2luIGZhaWxlZC4nKVxuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZGV2ZWxvcGl0L3VuZmV0Y2gjY2F2ZWF0c1xuICAgICAgICBsZXQgZXJyb3IgPSBuZXcgRXJyb3IocmVzcG9uc2Uuc3RhdHVzVGV4dClcbiAgICAgICAgZXJyb3IucmVzcG9uc2UgPSByZXNwb25zZVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgICdZb3UgaGF2ZSBhbiBlcnJvciBpbiB5b3VyIGNvZGUgb3IgdGhlcmUgYXJlIE5ldHdvcmsgaXNzdWVzLicsXG4gICAgICAgIGVycm9yXG4gICAgICApXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpXG4gICAgfVxuICB9XG5cbiAgcmVuZGVyICgpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPExheW91dD5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9J2xvZ2luJz5cbiAgICAgICAgICA8Zm9ybSBvblN1Ym1pdD17dGhpcy5oYW5kbGVTdWJtaXR9PlxuICAgICAgICAgICAgPGxhYmVsIGh0bWxGb3I9J3VzZXJuYW1lJz5HaXRIdWIgdXNlcm5hbWU8L2xhYmVsPlxuXG4gICAgICAgICAgICA8aW5wdXRcbiAgICAgICAgICAgICAgdHlwZT0ndGV4dCdcbiAgICAgICAgICAgICAgaWQ9J3VzZXJuYW1lJ1xuICAgICAgICAgICAgICBuYW1lPSd1c2VybmFtZSdcbiAgICAgICAgICAgICAgdmFsdWU9e3RoaXMuc3RhdGUudXNlcm5hbWV9XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLmhhbmRsZUNoYW5nZX1cbiAgICAgICAgICAgIC8+XG5cbiAgICAgICAgICAgIDxidXR0b24gdHlwZT0nc3VibWl0Jz5Mb2dpbjwvYnV0dG9uPlxuXG4gICAgICAgICAgICA8cCBjbGFzc05hbWU9e2BlcnJvciAke3RoaXMuc3RhdGUuZXJyb3IgJiYgJ3Nob3cnfWB9PlxuICAgICAgICAgICAgICB7dGhpcy5zdGF0ZS5lcnJvciAmJiBgRXJyb3I6ICR7dGhpcy5zdGF0ZS5lcnJvcn1gfVxuICAgICAgICAgICAgPC9wPlxuICAgICAgICAgIDwvZm9ybT5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxzdHlsZSBqc3g+e2BcbiAgICAgICAgICAubG9naW4ge1xuICAgICAgICAgICAgbWF4LXdpZHRoOiAzNDBweDtcbiAgICAgICAgICAgIG1hcmdpbjogMCBhdXRvO1xuICAgICAgICAgICAgcGFkZGluZzogMXJlbTtcbiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7XG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XG4gICAgICAgICAgfVxuICAgICAgICAgIGZvcm0ge1xuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGZsZXgtZmxvdzogY29sdW1uO1xuICAgICAgICAgIH1cbiAgICAgICAgICBsYWJlbCB7XG4gICAgICAgICAgICBmb250LXdlaWdodDogNjAwO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpbnB1dCB7XG4gICAgICAgICAgICBwYWRkaW5nOiA4cHg7XG4gICAgICAgICAgICBtYXJnaW46IDAuM3JlbSAwIDFyZW07XG4gICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjY2NjO1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xuICAgICAgICAgIH1cbiAgICAgICAgICAuZXJyb3Ige1xuICAgICAgICAgICAgbWFyZ2luOiAwLjVyZW0gMCAwO1xuICAgICAgICAgICAgZGlzcGxheTogbm9uZTtcbiAgICAgICAgICAgIGNvbG9yOiBicm93bjtcbiAgICAgICAgICB9XG4gICAgICAgICAgLmVycm9yLnNob3cge1xuICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7XG4gICAgICAgICAgfVxuICAgICAgICBgfTwvc3R5bGU+XG4gICAgICA8L0xheW91dD5cbiAgICApXG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgSW5kZXhcbiJdfQ== */\\n/*@ sourceURL=/var/www/html/node-twitter/client/pages/index.js */\"));\n    }\n  }]);\n\n  return Index;\n}(Component);\n\nexport default Index;","map":{"version":3,"sources":["/var/www/html/node-twitter/client/pages/index.js"],"names":["Component","fetch","Layout","login","Index","req","protocol","process","env","NODE_ENV","apiUrl","browser","window","location","host","headers","props","state","username","error","handleChange","bind","handleSubmit","event","setState","target","value","preventDefault","url","method","body","response","ok","json","token","console","log","Error","statusText","reject"],"mappings":";;;;;;;;;;;;;;;;;;;AAAA,SAASA,SAAT,QAA0B,OAA1B;AACA,OAAOC,KAAP,MAAkB,oBAAlB;AACA,OAAOC,MAAP,MAAmB,wBAAnB;AACA,SAASC,KAAT,QAAsB,eAAtB;;IAEMC,K;;;;;;;0CAC6B;AAAA,UAAPC,GAAO,QAAPA,GAAO;AAC/B,UAAMC,QAAQ,GAAGC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,GAAwC,OAAxC,GAAkD,MAAnE;AAEA,UAAMC,MAAM,GAAGH,OAAO,CAACI,OAAR,aACRL,QADQ,gBACMM,MAAM,CAACC,QAAP,CAAgBC,IADtB,+BAERR,QAFQ,gBAEMD,GAAG,CAACU,OAAJ,CAAYD,IAFlB,kBAAf;AAIA,aAAO;AAAEJ,QAAAA,MAAM,EAANA;AAAF,OAAP;AACD;;;AAED,iBAAaM,KAAb,EAAoB;AAAA;;AAAA;;AAClB,8BAAMA,KAAN;AAEA,UAAKC,KAAL,GAAa;AAAEC,MAAAA,QAAQ,EAAE,EAAZ;AAAgBC,MAAAA,KAAK,EAAE;AAAvB,KAAb;AACA,UAAKC,YAAL,GAAoB,MAAKA,YAAL,CAAkBC,IAAlB,+BAApB;AACA,UAAKC,YAAL,GAAoB,MAAKA,YAAL,CAAkBD,IAAlB,+BAApB;AALkB;AAMnB;;;;iCAEaE,K,EAAO;AACnB,WAAKC,QAAL,CAAc;AAAEN,QAAAA,QAAQ,EAAEK,KAAK,CAACE,MAAN,CAAaC;AAAzB,OAAd;AACD;;;;oGAEmBH,K;;;;;;;AAClBA,gBAAAA,KAAK,CAACI,cAAN;AACMT,gBAAAA,Q,GAAW,KAAKD,KAAL,CAAWC,Q;AACtBU,gBAAAA,G,GAAM,KAAKZ,KAAL,CAAWN,M;;;uBAGET,KAAK,CAAC2B,GAAD,EAAM;AAChCC,kBAAAA,MAAM,EAAE,MADwB;AAEhCd,kBAAAA,OAAO,EAAE;AAAE,oCAAgB;AAAlB,mBAFuB;AAGhCe,kBAAAA,IAAI,EAAE,gBAAe;AAAEZ,oBAAAA,QAAQ,EAARA;AAAF,mBAAf;AAH0B,iBAAN,C;;;AAAtBa,gBAAAA,Q;;qBAKFA,QAAQ,CAACC,E;;;;;;uBACaD,QAAQ,CAACE,IAAT,E;;;;AAAhBC,gBAAAA,K,wBAAAA,K;AACR/B,gBAAAA,KAAK,CAAC;AAAE+B,kBAAAA,KAAK,EAALA;AAAF,iBAAD,CAAL;;;;;AAEAC,gBAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ,E,CACA;;AACIjB,gBAAAA,K,GAAQ,IAAIkB,KAAJ,CAAUN,QAAQ,CAACO,UAAnB,C;AACZnB,gBAAAA,KAAK,CAACY,QAAN,GAAiBA,QAAjB;iDACO,SAAQQ,MAAR,CAAepB,KAAf,C;;;;;;;;;AAGTgB,gBAAAA,OAAO,CAAChB,KAAR,CACE,6DADF;sBAIM,IAAIkB,KAAJ,a;;;;;;;;;;;;;;;;;;6BAIA;AACR,0BACE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAA,2CAAe,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAM,QAAA,QAAQ,EAAE,KAAKf,YAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACE;AAAO,QAAA,OAAO,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BADF,eAGE;AACE,QAAA,IAAI,EAAC,MADP;AAEE,QAAA,EAAE,EAAC,UAFL;AAGE,QAAA,IAAI,EAAC,UAHP;AAIE,QAAA,KAAK,EAAE,KAAKL,KAAL,CAAWC,QAJpB;AAKE,QAAA,QAAQ,EAAE,KAAKE,YALjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAHF,eAWE;AAAQ,QAAA,IAAI,EAAC,QAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAXF,eAaE;AAAA,2DAAuB,KAAKH,KAAL,CAAWE,KAAX,IAAoB,MAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,KAAKF,KAAL,CAAWE,KAAX,qBAA8B,KAAKF,KAAL,CAAWE,KAAzC,CADH,CAbF,CADF,CADF;AAAA;AAAA;AAAA,okKADF;AAqDD;;;;EA3GiBnB,S;;AA8GpB,eAAeI,KAAf","sourcesContent":["import { Component } from 'react'\nimport fetch from 'isomorphic-unfetch'\nimport Layout from './../components/layout';\nimport { login } from '../utils/auth'\n\nclass Index extends Component {\n  static getInitialProps ({ req }) {\n    const protocol = process.env.NODE_ENV === 'production' ? 'https' : 'http'\n\n    const apiUrl = process.browser\n      ? `${protocol}://${window.location.host}/api/login.js`\n      : `${protocol}://${req.headers.host}/api/login.js`\n\n    return { apiUrl }\n  }\n\n  constructor (props) {\n    super(props)\n\n    this.state = { username: '', error: '' }\n    this.handleChange = this.handleChange.bind(this)\n    this.handleSubmit = this.handleSubmit.bind(this)\n  }\n\n  handleChange (event) {\n    this.setState({ username: event.target.value })\n  }\n\n  async handleSubmit (event) {\n    event.preventDefault()\n    const username = this.state.username\n    const url = this.props.apiUrl\n\n    try {\n      const response = await fetch(url, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ username })\n      })\n      if (response.ok) {\n        const { token } = await response.json()\n        login({ token })\n      } else {\n        console.log('Login failed.')\n        // https://github.com/developit/unfetch#caveats\n        let error = new Error(response.statusText)\n        error.response = response\n        return Promise.reject(error)\n      }\n    } catch (error) {\n      console.error(\n        'You have an error in your code or there are Network issues.',\n        error\n      )\n      throw new Error(error)\n    }\n  }\n\n  render () {\n    return (\n      <Layout>\n        <div className='login'>\n          <form onSubmit={this.handleSubmit}>\n            <label htmlFor='username'>GitHub username</label>\n\n            <input\n              type='text'\n              id='username'\n              name='username'\n              value={this.state.username}\n              onChange={this.handleChange}\n            />\n\n            <button type='submit'>Login</button>\n\n            <p className={`error ${this.state.error && 'show'}`}>\n              {this.state.error && `Error: ${this.state.error}`}\n            </p>\n          </form>\n        </div>\n        <style jsx>{`\n          .login {\n            max-width: 340px;\n            margin: 0 auto;\n            padding: 1rem;\n            border: 1px solid #ccc;\n            border-radius: 4px;\n          }\n          form {\n            display: flex;\n            flex-flow: column;\n          }\n          label {\n            font-weight: 600;\n          }\n          input {\n            padding: 8px;\n            margin: 0.3rem 0 1rem;\n            border: 1px solid #ccc;\n            border-radius: 4px;\n          }\n          .error {\n            margin: 0.5rem 0 0;\n            display: none;\n            color: brown;\n          }\n          .error.show {\n            display: block;\n          }\n        `}</style>\n      </Layout>\n    )\n  }\n}\n\nexport default Index\n"]},"metadata":{},"sourceType":"module"}